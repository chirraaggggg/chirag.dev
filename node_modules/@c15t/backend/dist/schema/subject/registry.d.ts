import type { GenericEndpointContext, RegistryContext } from '../../pkgs/types';
import type { Subject } from './schema';
/**
 * Creates and returns a set of subject-related adapter methods to interact with the database.
 *
 * These methods provide a consistent interface for creating and finding
 * subject records while applying hooks and enforcing data validation rules.
 *
 * @param adapter - The database adapter used for direct database operations
 * @param ctx - The context object containing the database adapter, hooks, and options
 * @returns An object containing type-safe subject operations
 *
 * @example
 * ```typescript
 * const subjectAdapter = createSubjectAdapter(
 *   databaseAdapter,
 *   createWithHooks,
 *   c15tOptions
 * );
 *
 * // Create a new subject
 * const subject = await subjectAdapter.createSubject({
 *   externalId: 'external-123',
 *   identityProvider: 'auth0'
 * });
 * ```
 */
export declare function subjectRegistry({ adapter, ...ctx }: RegistryContext): {
    /**
     * Creates a new subject record in the database.
     *
     * Automatically sets creation and update timestamps and applies any
     * configured hooks during the creation process.
     *
     * @param subject - Subject data to create (without id and timestamps)
     * @param context - Optional endpoint context for hooks
     * @returns The created subject with all fields populated
     *
     * @throws May throw an error if hooks prevent creation or if database operations fail
     */
    createSubject: (subject: Omit<Subject, "id" | "createdAt" | "updatedAt"> & Partial<Subject>, context?: GenericEndpointContext) => Promise<{
        id: string;
        isIdentified: boolean;
        createdAt: Date;
        updatedAt: Date;
        externalId?: string | null | undefined;
        identityProvider?: string | undefined;
        lastIpAddress?: string | undefined;
    } | null>;
    /**
     * Finds an existing subject or creates a new one if needed.
     * If both subjectId and externalSubjectId are provided, validates they match the same subject.
     * Creates a new anonymous subject only if no identifiers are provided.
     *
     * @param params - Parameters for finding or creating the subject
     * @returns The existing or newly created subject
     * @throws APIError if subject validation fails or creation fails
     */
    findOrCreateSubject: ({ subjectId, externalSubjectId, identityProvider, ipAddress, context, }: {
        subjectId?: string;
        externalSubjectId?: string;
        identityProvider?: string;
        ipAddress?: string;
        context?: GenericEndpointContext;
    }) => Promise<{
        id: string;
        isIdentified: boolean;
        createdAt: Date;
        updatedAt: Date;
        externalId?: string | null | undefined;
        identityProvider?: string | undefined;
        lastIpAddress?: string | undefined;
    } | null>;
    /**
     * Finds a subject by their unique ID.
     *
     * Returns the subject with processed output fields according to the schema configuration.
     *
     * @param subjectId - The unique identifier of the subject
     * @returns The subject object if found, null otherwise
     */
    findSubjectById: (subjectId: string) => Promise<{
        id: string;
        isIdentified: boolean;
        createdAt: Date;
        updatedAt: Date;
        externalId?: string | null | undefined;
        identityProvider?: string | undefined;
        lastIpAddress?: string | undefined;
    } | null>;
    /**
     * Finds a subject by their external ID.
     *
     * This is useful when integrating with external authentication systems
     * where subjects are identified by a provider-specific ID.
     *
     * @param externalId - The external identifier of the subject
     * @returns The subject object if found, null otherwise
     */
    findSubjectByExternalId: (externalId: string) => Promise<{
        id: string;
        isIdentified: boolean;
        createdAt: Date;
        updatedAt: Date;
        externalId?: string | null | undefined;
        identityProvider?: string | undefined;
        lastIpAddress?: string | undefined;
    } | null>;
};
//# sourceMappingURL=registry.d.ts.map