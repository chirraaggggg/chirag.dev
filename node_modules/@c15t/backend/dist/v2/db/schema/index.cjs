"use strict";
var __webpack_require__ = {};
(()=>{
    __webpack_require__.d = (exports1, definition)=>{
        for(var key in definition)if (__webpack_require__.o(definition, key) && !__webpack_require__.o(exports1, key)) Object.defineProperty(exports1, key, {
            enumerable: true,
            get: definition[key]
        });
    };
})();
(()=>{
    __webpack_require__.o = (obj, prop)=>Object.prototype.hasOwnProperty.call(obj, prop);
})();
(()=>{
    __webpack_require__.r = (exports1)=>{
        if ('undefined' != typeof Symbol && Symbol.toStringTag) Object.defineProperty(exports1, Symbol.toStringTag, {
            value: 'Module'
        });
        Object.defineProperty(exports1, '__esModule', {
            value: true
        });
    };
})();
var __webpack_exports__ = {};
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
    consentSchema: ()=>consentSchema,
    consentPurposeSchema: ()=>consentPurposeSchema,
    DB: ()=>DB,
    PolicyTypeSchema: ()=>PolicyTypeSchema,
    auditLogSchema: ()=>auditLogSchema,
    consentPolicySchema: ()=>consentPolicySchema,
    consentTable: ()=>consentTable,
    domainTable: ()=>domainTable,
    subjectTable: ()=>subjectTable,
    v1: ()=>v1,
    consentPolicyTable: ()=>consentPolicyTable,
    consentRecordTable: ()=>consentRecordTable,
    consentStatusSchema: ()=>consentStatusSchema,
    consentRecordSchema: ()=>consentRecordSchema,
    auditLogTable: ()=>auditLogTable,
    consentPurposeTable: ()=>consentPurposeTable,
    subjectSchema: ()=>subjectSchema,
    domainSchema: ()=>domainSchema
});
const external_fumadb_namespaceObject = require("fumadb");
const schema_namespaceObject = require("fumadb/schema");
const external_zod_namespaceObject = require("zod");
const auditLogTable = (0, schema_namespaceObject.table)('auditLog', {
    id: (0, schema_namespaceObject.idColumn)('id', 'varchar(255)'),
    entityType: (0, schema_namespaceObject.column)('entityType', 'string'),
    entityId: (0, schema_namespaceObject.column)('entityId', 'string'),
    actionType: (0, schema_namespaceObject.column)('actionType', 'string'),
    subjectId: (0, schema_namespaceObject.column)('subjectId', 'string').nullable(),
    ipAddress: (0, schema_namespaceObject.column)('ipAddress', 'string').nullable(),
    userAgent: (0, schema_namespaceObject.column)('userAgent', 'string').nullable(),
    changes: (0, schema_namespaceObject.column)('changes', 'json').nullable(),
    metadata: (0, schema_namespaceObject.column)('metadata', 'json').nullable(),
    createdAt: (0, schema_namespaceObject.column)('createdAt', 'timestamp').defaultTo$('now'),
    eventTimezone: (0, schema_namespaceObject.column)('eventTimezone', 'string').defaultTo$(()=>'UTC')
});
const auditLogSchema = external_zod_namespaceObject.z.object({
    id: external_zod_namespaceObject.z.string(),
    entityType: external_zod_namespaceObject.z.string(),
    entityId: external_zod_namespaceObject.z.string(),
    actionType: external_zod_namespaceObject.z.string(),
    subjectId: external_zod_namespaceObject.z.string().optional(),
    ipAddress: external_zod_namespaceObject.z.string().optional(),
    userAgent: external_zod_namespaceObject.z.string().optional(),
    changes: external_zod_namespaceObject.z.record(external_zod_namespaceObject.z.string(), external_zod_namespaceObject.z.unknown()).optional(),
    metadata: external_zod_namespaceObject.z.record(external_zod_namespaceObject.z.string(), external_zod_namespaceObject.z.unknown()).optional(),
    createdAt: external_zod_namespaceObject.z.date().prefault(()=>new Date()),
    eventTimezone: external_zod_namespaceObject.z.string().prefault('UTC')
});
const consentTable = (0, schema_namespaceObject.table)('consent', {
    id: (0, schema_namespaceObject.idColumn)('id', 'varchar(255)'),
    subjectId: (0, schema_namespaceObject.column)('subjectId', 'string'),
    domainId: (0, schema_namespaceObject.column)('domainId', 'string'),
    policyId: (0, schema_namespaceObject.column)('policyId', 'string').nullable(),
    purposeIds: (0, schema_namespaceObject.column)('purposeIds', 'json'),
    metadata: (0, schema_namespaceObject.column)('metadata', 'json').nullable(),
    ipAddress: (0, schema_namespaceObject.column)('ipAddress', 'string').nullable(),
    userAgent: (0, schema_namespaceObject.column)('userAgent', 'string').nullable(),
    status: (0, schema_namespaceObject.column)('status', 'string').defaultTo$(()=>'active'),
    withdrawalReason: (0, schema_namespaceObject.column)('withdrawalReason', 'string').nullable(),
    givenAt: (0, schema_namespaceObject.column)('givenAt', 'timestamp').defaultTo$('now'),
    validUntil: (0, schema_namespaceObject.column)('validUntil', 'timestamp').nullable(),
    isActive: (0, schema_namespaceObject.column)('isActive', 'bool').defaultTo$(()=>true)
});
const consentStatusSchema = external_zod_namespaceObject.z["enum"]([
    'active',
    'withdrawn',
    'expired'
]);
const consentSchema = external_zod_namespaceObject.z.object({
    id: external_zod_namespaceObject.z.string(),
    subjectId: external_zod_namespaceObject.z.string(),
    domainId: external_zod_namespaceObject.z.string(),
    purposeIds: external_zod_namespaceObject.z.array(external_zod_namespaceObject.z.string()),
    metadata: external_zod_namespaceObject.z.record(external_zod_namespaceObject.z.string(), external_zod_namespaceObject.z.unknown()).nullish(),
    policyId: external_zod_namespaceObject.z.string().optional(),
    ipAddress: external_zod_namespaceObject.z.string().nullish(),
    userAgent: external_zod_namespaceObject.z.string().nullish(),
    status: consentStatusSchema.prefault('active'),
    withdrawalReason: external_zod_namespaceObject.z.string().nullish(),
    givenAt: external_zod_namespaceObject.z.date().prefault(()=>new Date()),
    validUntil: external_zod_namespaceObject.z.date().nullish(),
    isActive: external_zod_namespaceObject.z.boolean().prefault(true)
});
const consentPolicyTable = (0, schema_namespaceObject.table)('consentPolicy', {
    id: (0, schema_namespaceObject.idColumn)('id', 'varchar(255)'),
    version: (0, schema_namespaceObject.column)('version', 'string'),
    type: (0, schema_namespaceObject.column)('type', 'string'),
    name: (0, schema_namespaceObject.column)('name', 'string'),
    effectiveDate: (0, schema_namespaceObject.column)('effectiveDate', 'timestamp'),
    expirationDate: (0, schema_namespaceObject.column)('expirationDate', 'timestamp').nullable(),
    content: (0, schema_namespaceObject.column)('content', 'string'),
    contentHash: (0, schema_namespaceObject.column)('contentHash', 'string'),
    isActive: (0, schema_namespaceObject.column)('isActive', 'bool').defaultTo$(()=>true),
    createdAt: (0, schema_namespaceObject.column)('createdAt', 'timestamp').defaultTo$('now')
});
const PolicyTypeSchema = external_zod_namespaceObject.z["enum"]([
    'cookie_banner',
    'privacy_policy',
    'dpa',
    'terms_and_conditions',
    'marketing_communications',
    'age_verification',
    'other'
]);
const consentPolicySchema = external_zod_namespaceObject.z.object({
    id: external_zod_namespaceObject.z.string(),
    version: external_zod_namespaceObject.z.string(),
    type: PolicyTypeSchema,
    name: external_zod_namespaceObject.z.string(),
    effectiveDate: external_zod_namespaceObject.z.date(),
    expirationDate: external_zod_namespaceObject.z.date().nullish(),
    content: external_zod_namespaceObject.z.string(),
    contentHash: external_zod_namespaceObject.z.string(),
    isActive: external_zod_namespaceObject.z.boolean().prefault(true),
    createdAt: external_zod_namespaceObject.z.date().prefault(()=>new Date())
});
const consentPurposeTable = (0, schema_namespaceObject.table)('consentPurpose', {
    id: (0, schema_namespaceObject.idColumn)('id', 'varchar(255)'),
    code: (0, schema_namespaceObject.column)('code', 'string'),
    name: (0, schema_namespaceObject.column)('name', 'string'),
    description: (0, schema_namespaceObject.column)("description", 'string'),
    isEssential: (0, schema_namespaceObject.column)('isEssential', 'bool'),
    dataCategory: (0, schema_namespaceObject.column)('dataCategory', 'string').nullable(),
    legalBasis: (0, schema_namespaceObject.column)('legalBasis', 'string').nullable(),
    isActive: (0, schema_namespaceObject.column)('isActive', 'bool').defaultTo$(()=>true),
    createdAt: (0, schema_namespaceObject.column)('createdAt', 'timestamp').defaultTo$('now'),
    updatedAt: (0, schema_namespaceObject.column)('updatedAt', 'timestamp').defaultTo$('now')
});
const consentPurposeSchema = external_zod_namespaceObject.z.object({
    id: external_zod_namespaceObject.z.string(),
    code: external_zod_namespaceObject.z.string(),
    name: external_zod_namespaceObject.z.string(),
    description: external_zod_namespaceObject.z.string(),
    isEssential: external_zod_namespaceObject.z.boolean(),
    dataCategory: external_zod_namespaceObject.z.string().nullish(),
    legalBasis: external_zod_namespaceObject.z.string().nullish(),
    isActive: external_zod_namespaceObject.z.boolean().prefault(true),
    createdAt: external_zod_namespaceObject.z.date().prefault(()=>new Date()),
    updatedAt: external_zod_namespaceObject.z.date().prefault(()=>new Date())
});
const consentRecordTable = (0, schema_namespaceObject.table)('consentRecord', {
    id: (0, schema_namespaceObject.idColumn)('id', 'varchar(255)'),
    subjectId: (0, schema_namespaceObject.column)('subjectId', 'string'),
    consentId: (0, schema_namespaceObject.column)('consentId', 'string').nullable(),
    actionType: (0, schema_namespaceObject.column)('actionType', 'string'),
    details: (0, schema_namespaceObject.column)('details', 'json').nullable(),
    createdAt: (0, schema_namespaceObject.column)('createdAt', 'timestamp').defaultTo$('now')
});
const consentRecordSchema = external_zod_namespaceObject.z.object({
    id: external_zod_namespaceObject.z.string(),
    subjectId: external_zod_namespaceObject.z.string(),
    consentId: external_zod_namespaceObject.z.string().nullish(),
    actionType: external_zod_namespaceObject.z.string(),
    details: external_zod_namespaceObject.z.record(external_zod_namespaceObject.z.string(), external_zod_namespaceObject.z.unknown()).nullish(),
    createdAt: external_zod_namespaceObject.z.date().prefault(()=>new Date())
});
const domainTable = (0, schema_namespaceObject.table)('domain', {
    id: (0, schema_namespaceObject.idColumn)('id', 'varchar(255)'),
    name: (0, schema_namespaceObject.column)('name', 'string').unique(),
    description: (0, schema_namespaceObject.column)("description", 'string').nullable(),
    allowedOrigins: (0, schema_namespaceObject.column)('allowedOrigins', 'json').nullable(),
    isVerified: (0, schema_namespaceObject.column)('isVerified', 'bool').defaultTo$(()=>true),
    isActive: (0, schema_namespaceObject.column)('isActive', 'bool').defaultTo$(()=>true),
    createdAt: (0, schema_namespaceObject.column)('createdAt', 'timestamp').defaultTo$('now'),
    updatedAt: (0, schema_namespaceObject.column)('updatedAt', 'timestamp').defaultTo$('now')
});
const domainSchema = external_zod_namespaceObject.z.object({
    id: external_zod_namespaceObject.z.string(),
    name: external_zod_namespaceObject.z.string(),
    description: external_zod_namespaceObject.z.string().nullish(),
    allowedOrigins: external_zod_namespaceObject.z.array(external_zod_namespaceObject.z.string()).nullish(),
    isVerified: external_zod_namespaceObject.z.boolean().prefault(true),
    isActive: external_zod_namespaceObject.z.boolean().prefault(true),
    createdAt: external_zod_namespaceObject.z.date().prefault(()=>new Date()),
    updatedAt: external_zod_namespaceObject.z.date().prefault(()=>new Date())
});
const subjectTable = (0, schema_namespaceObject.table)('subject', {
    id: (0, schema_namespaceObject.idColumn)('id', 'varchar(255)'),
    isIdentified: (0, schema_namespaceObject.column)('isIdentified', 'bool').defaultTo$(()=>false),
    externalId: (0, schema_namespaceObject.column)('externalId', 'string').nullable(),
    identityProvider: (0, schema_namespaceObject.column)('identityProvider', 'string').nullable(),
    lastIpAddress: (0, schema_namespaceObject.column)('lastIpAddress', 'string').nullable(),
    subjectTimezone: (0, schema_namespaceObject.column)('subjectTimezone', 'string').nullable(),
    createdAt: (0, schema_namespaceObject.column)('createdAt', 'timestamp').defaultTo$('now'),
    updatedAt: (0, schema_namespaceObject.column)('updatedAt', 'timestamp').defaultTo$('now')
});
const subjectSchema = external_zod_namespaceObject.z.object({
    id: external_zod_namespaceObject.z.string(),
    isIdentified: external_zod_namespaceObject.z.boolean().prefault(false),
    externalId: external_zod_namespaceObject.z.string().nullish(),
    identityProvider: external_zod_namespaceObject.z.string().nullish(),
    lastIpAddress: external_zod_namespaceObject.z.string().optional(),
    subjectTimezone: external_zod_namespaceObject.z.string().nullish(),
    createdAt: external_zod_namespaceObject.z.date().prefault(()=>new Date()),
    updatedAt: external_zod_namespaceObject.z.date().prefault(()=>new Date())
});
const v1 = (0, schema_namespaceObject.schema)({
    version: '1.0.0',
    tables: {
        subject: subjectTable,
        domain: domainTable,
        consentPolicy: consentPolicyTable,
        consentPurpose: consentPurposeTable,
        consent: consentTable,
        auditLog: auditLogTable,
        consentRecord: consentRecordTable
    },
    relations: {
        subject: ({ many })=>({
                consents: many('consent'),
                consentRecords: many('consentRecord'),
                auditLogs: many('auditLog')
            }),
        domain: ({ many })=>({
                consents: many('consent')
            }),
        consentPolicy: ({ many })=>({
                consents: many('consent')
            }),
        consentPurpose: ()=>({}),
        consent: ({ one, many })=>({
                subject: one('subject', [
                    'subjectId',
                    'id'
                ]).foreignKey(),
                domain: one('domain', [
                    'domainId',
                    'id'
                ]).foreignKey(),
                policy: one('consentPolicy', [
                    'policyId',
                    'id'
                ]).foreignKey(),
                consentRecords: many('consentRecord')
            }),
        consentRecord: ({ one })=>({
                subject: one('subject', [
                    'subjectId',
                    'id'
                ]).foreignKey(),
                consent: one('consent', [
                    'consentId',
                    'id'
                ]).foreignKey()
            }),
        auditLog: ({ one })=>({
                subject: one('subject', [
                    'subjectId',
                    'id'
                ]).foreignKey()
            })
    }
});
const DB = (0, external_fumadb_namespaceObject.fumadb)({
    namespace: 'c15t',
    schemas: [
        v1
    ]
});
exports.DB = __webpack_exports__.DB;
exports.PolicyTypeSchema = __webpack_exports__.PolicyTypeSchema;
exports.auditLogSchema = __webpack_exports__.auditLogSchema;
exports.auditLogTable = __webpack_exports__.auditLogTable;
exports.consentPolicySchema = __webpack_exports__.consentPolicySchema;
exports.consentPolicyTable = __webpack_exports__.consentPolicyTable;
exports.consentPurposeSchema = __webpack_exports__.consentPurposeSchema;
exports.consentPurposeTable = __webpack_exports__.consentPurposeTable;
exports.consentRecordSchema = __webpack_exports__.consentRecordSchema;
exports.consentRecordTable = __webpack_exports__.consentRecordTable;
exports.consentSchema = __webpack_exports__.consentSchema;
exports.consentStatusSchema = __webpack_exports__.consentStatusSchema;
exports.consentTable = __webpack_exports__.consentTable;
exports.domainSchema = __webpack_exports__.domainSchema;
exports.domainTable = __webpack_exports__.domainTable;
exports.subjectSchema = __webpack_exports__.subjectSchema;
exports.subjectTable = __webpack_exports__.subjectTable;
exports.v1 = __webpack_exports__.v1;
for(var __webpack_i__ in __webpack_exports__)if (-1 === [
    "DB",
    "PolicyTypeSchema",
    "auditLogSchema",
    "auditLogTable",
    "consentPolicySchema",
    "consentPolicyTable",
    "consentPurposeSchema",
    "consentPurposeTable",
    "consentRecordSchema",
    "consentRecordTable",
    "consentSchema",
    "consentStatusSchema",
    "consentTable",
    "domainSchema",
    "domainTable",
    "subjectSchema",
    "subjectTable",
    "v1"
].indexOf(__webpack_i__)) exports[__webpack_i__] = __webpack_exports__[__webpack_i__];
Object.defineProperty(exports, '__esModule', {
    value: true
});
