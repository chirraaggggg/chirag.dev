async function migrator(options) {
    const { db } = options;
    let version;
    try {
        version = await db.version();
    } catch  {
        version = 'legacy';
    }
    const migratorInstance = db.adapter?.createMigrationEngine ? db.createMigrator() : void 0;
    const schema = db.adapter?.generateSchema ? db.generateSchema(options.schema) : void 0;
    if (migratorInstance) switch(options.schema){
        case 'latest':
            return await migratorInstance.migrateToLatest({
                mode: 'legacy' === version ? 'from-database' : 'from-schema'
            });
        default:
            return await migratorInstance.migrateTo(options.schema, {
                mode: 'legacy' === version ? 'from-database' : 'from-schema'
            });
    }
    if (schema) return {
        code: schema.code,
        path: schema.path
    };
    throw new Error('Adapter does not support migrations or schema generation');
}
export { migrator };
