import{jsx as e}from"react/jsx-runtime";import{defaultTranslationConfig as t}from"c15t";import{expect as o,test as a,vi as s}from"vitest";import{ConsentManagerDialog as n}from"../consent-manager-dialog.js";import l from"../../../utils/test-helpers.js";import r from"../consent-manager-dialog.module.js";let d=[{testId:"consent-manager-dialog-root",themeKey:"dialog.root",styles:"custom-dialog-root"},{testId:"consent-manager-dialog-overlay",themeKey:"dialog.overlay",styles:"custom-dialog-overlay"},{testId:"consent-manager-dialog-header",themeKey:"dialog.header",styles:"custom-dialog-header"},{testId:"consent-manager-dialog-title",themeKey:"dialog.title",styles:"custom-dialog-title"},{testId:"consent-manager-dialog-description",themeKey:"dialog.description",styles:"custom-dialog-description"},{testId:"consent-manager-dialog-content",themeKey:"dialog.content",styles:"custom-dialog-content"},{testId:"consent-manager-dialog-footer",themeKey:"dialog.footer",styles:"custom-dialog-footer"}];s.mock("~/hooks/use-consent-manager",()=>({useConsentManager:s.fn().mockReturnValue({isPrivacyDialogOpen:!0,getDisplayedConsents:s.fn().mockReturnValue([]),saveConsents:s.fn(),setShowPopup:s.fn(),setIsPrivacyDialogOpen:s.fn(),translationConfig:{defaultLanguage:"en"}})})),s.mock("~/hooks/use-translations",()=>({useTranslations:s.fn().mockReturnValue(t.translations.en)})),a("should apply string classNames from theme prop to all dialog elements",async()=>{let t=e(n,{open:!0,scrollLock:!0,theme:d.reduce((e,{themeKey:t,styles:o})=>(e[t]=o,e),{})});await l({component:t,testCases:d.map(({testId:e,styles:t})=>({testId:e,styles:t}))})}),a("should apply className and style objects from theme prop to all dialog elements",async()=>{let t={backgroundColor:"#ffffff",padding:"20px",border:"1px solid #000000"},o=d.map(({testId:e,themeKey:o,styles:a})=>({testId:e,themeKey:o,className:a,style:t})),a=e(n,{open:!0,scrollLock:!0,theme:o.reduce((e,{themeKey:t,className:o,style:a})=>(e[t]={className:o,style:a},e),{})});await l({component:a,testCases:o.map(({testId:e,className:t,style:o})=>({testId:e,styles:{className:t,style:o}}))})}),a("should remove default styles but keep custom classNames when top-level noStyle prop is true",async()=>{let t=e(n,{scrollLock:!0,noStyle:!0,open:!0,theme:d.reduce((e,{themeKey:t,styles:o})=>(e[t]=o,e),{})});await l({component:t,testCases:d.map(({testId:e,styles:t})=>({testId:e,styles:t})),noStyle:!0})}),a("should remove default styles but keep custom classNames when theme object provides noStyle: true",async()=>{let t=e(n,{scrollLock:!0,open:!0,theme:d.reduce((e,{themeKey:t,styles:o})=>(e[t]={className:o,noStyle:!0},e),{})});await l({component:t,testCases:d.map(({testId:e,styles:t})=>({testId:e,styles:{className:t}}))})}),a("should correctly apply styles when theme prop uses mixed string and object formats",async()=>{let t=e(n,{scrollLock:!0,theme:{"dialog.root":{className:"custom-dialog-root",style:{backgroundColor:"rgb(255, 255, 255)",padding:"16px"}},"dialog.overlay":"custom-dialog-overlay"},open:!0});await l({component:t,testCases:[{testId:"consent-manager-dialog-root",styles:{className:"custom-dialog-root",style:{backgroundColor:"rgb(255, 255, 255)",padding:"16px"}}},{testId:"consent-manager-dialog-overlay",styles:"custom-dialog-overlay"}]})}),a("should handle empty strings and empty style objects in theme prop gracefully",async()=>{let t=e(n,{scrollLock:!0,open:!0,theme:{"dialog.root":"","dialog.overlay":"","dialog.content":{className:"",style:{margin:"0",padding:"0"}}}});await l({component:t,testCases:[{testId:"consent-manager-dialog-root",styles:""},{testId:"consent-manager-dialog-overlay",styles:""},{testId:"consent-manager-dialog-content",styles:{className:"",style:{margin:"0",padding:"0"}}}]})}),a("should override base layer styles",async()=>{let t=document.createElement("style");t.textContent=`
		.custom-dialog-background {
			background-color: rgb(255, 0, 0) !important;
		}
		.custom-dialog-text {
			color: rgb(0, 255, 0) !important;
		}
	`,document.head.appendChild(t);let a=e(n,{theme:{"dialog.root":"custom-dialog-background","dialog.title":"custom-dialog-text"}});await l({component:a,testCases:[{testId:"consent-manager-dialog-root",styles:"custom-dialog-background"},{testId:"consent-manager-dialog-title",styles:"custom-dialog-text"}]});let s=document.querySelector('[data-testid="consent-manager-dialog-root"]'),r=document.querySelector('[data-testid="consent-manager-dialog-title"]');if(!s||!r)throw Error("Required elements not found in the document");o(getComputedStyle(s).backgroundColor).toBe("rgb(255, 0, 0)"),o(getComputedStyle(r).color).toBe("rgb(0, 255, 0)"),document.head.removeChild(t)}),a("Base layer styles are applied when no custom classes are provided",async()=>{let t=e(n,{});await l({component:t,testCases:[]});let a=document.querySelector('[data-testid="consent-manager-dialog-root"]'),s=document.querySelector('[data-testid="consent-manager-dialog-title"]');if(!a||!s)throw Error("Required elements not found in the document");o(getComputedStyle(a).backgroundColor).toBe("rgb(255, 255, 255)"),o(getComputedStyle(s).color).toBe("rgb(23, 23, 23)")}),a("Multiple custom classes can be applied and override base layer",async()=>{let t=document.createElement("style");t.textContent=`
		.custom-padding {
			padding: 32px !important;
		}
		.custom-border {
			border: 2px solid rgb(0, 0, 255) !important;
		}
	`,document.head.appendChild(t);let a=e(n,{theme:{"dialog.root":"custom-padding custom-border"}});await l({component:a,testCases:[{testId:"consent-manager-dialog-root",styles:"custom-padding custom-border"}]});let s=document.querySelector('[data-testid="consent-manager-dialog-root"]');if(!s)throw Error("Required elements not found in the document");o(getComputedStyle(s).padding).toBe("32px"),o(getComputedStyle(s).border).toBe("2px solid rgb(0, 0, 255)"),document.head.removeChild(t)}),a("All consent manager dialog components should have their base classes applied",async()=>{let t=e(n,{open:!0}),a={root:r.root||"",card:r.card||"",header:r.header||"",title:r.title||"",description:r.description||"",content:r.content||"",footer:r.footer||"",overlay:r.overlay||""};for(let[e,s]of(await l({component:t,testCases:[{testId:"consent-manager-dialog-root",styles:`${r.card} ${r.card} ${r.card}`},{testId:"consent-manager-dialog-card",styles:a.card},{testId:"consent-manager-dialog-header",styles:a.header},{testId:"consent-manager-dialog-title",styles:a.title},{testId:"consent-manager-dialog-description",styles:a.description},{testId:"consent-manager-dialog-content",styles:a.content},{testId:"consent-manager-dialog-footer",styles:a.footer},{testId:"consent-manager-dialog-overlay",styles:a.overlay}]}),Object.entries(a)))o(s,`Base class for ${e} should not be empty`).not.toBe("")});