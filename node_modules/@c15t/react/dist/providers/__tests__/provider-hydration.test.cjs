"use strict";const __rslib_import_meta_url__="undefined"==typeof document?new(require("url".replace("",""))).URL("file:"+__filename).href:document.currentScript&&document.currentScript.src||new URL("main.js",document.baseURI).href;var __webpack_exports__={};const jsx_runtime_namespaceObject=require("react/jsx-runtime"),external_vitest_namespaceObject=require("vitest"),external_vitest_browser_react_namespaceObject=require("vitest-browser-react"),external_consent_manager_provider_cjs_namespaceObject=require("../consent-manager-provider.cjs"),MockSSRProvider=({children:e})=>(0,jsx_runtime_namespaceObject.jsx)("div",{"data-testid":"ssr-provider",children:e}),RenderTracker=({label:e})=>(0,jsx_runtime_namespaceObject.jsx)("div",{"data-testid":`render-${e}`,children:e});for(var __webpack_i__ in(0,external_vitest_namespaceObject.describe)("ConsentManagerProvider Hydration Behavior",()=>{(0,external_vitest_namespaceObject.beforeEach)(()=>{external_vitest_namespaceObject.vi.resetAllMocks(),external_vitest_namespaceObject.vi.useFakeTimers(),(0,external_consent_manager_provider_cjs_namespaceObject.clearConsentManagerCache)()}),(0,external_vitest_namespaceObject.afterEach)(()=>{external_vitest_namespaceObject.vi.clearAllMocks(),external_vitest_namespaceObject.vi.useRealTimers()}),(0,external_vitest_namespaceObject.it)("should render children immediately without blocking during hydration",async()=>{let{getByTestId:e}=(0,external_vitest_browser_react_namespaceObject.render)((0,jsx_runtime_namespaceObject.jsx)(external_consent_manager_provider_cjs_namespaceObject.ConsentManagerProvider,{options:{mode:"offline",consentCategories:["necessary","marketing"]},children:(0,jsx_runtime_namespaceObject.jsx)(RenderTracker,{label:"child"})}));(0,external_vitest_namespaceObject.expect)(e("render-child")).toBeInTheDocument(),(0,external_vitest_namespaceObject.expect)(e("render-child")).toHaveTextContent("child"),await external_vitest_namespaceObject.vi.runAllTimersAsync(),(0,external_vitest_namespaceObject.expect)(e("render-child")).toBeInTheDocument()}),(0,external_vitest_namespaceObject.it)("should not block SSR provider content when ConsentManager wraps SSR provider",async()=>{let{getByTestId:e}=(0,external_vitest_browser_react_namespaceObject.render)((0,jsx_runtime_namespaceObject.jsx)(external_consent_manager_provider_cjs_namespaceObject.ConsentManagerProvider,{options:{mode:"offline",consentCategories:["necessary","marketing"]},children:(0,jsx_runtime_namespaceObject.jsx)(MockSSRProvider,{children:(0,jsx_runtime_namespaceObject.jsx)(RenderTracker,{label:"ssr-content"})})}));(0,external_vitest_namespaceObject.expect)(e("ssr-provider")).toBeInTheDocument(),(0,external_vitest_namespaceObject.expect)(e("render-ssr-content")).toBeInTheDocument(),(0,external_vitest_namespaceObject.expect)(e("render-ssr-content")).toHaveTextContent("ssr-content"),await external_vitest_namespaceObject.vi.runAllTimersAsync(),(0,external_vitest_namespaceObject.expect)(e("ssr-provider")).toBeInTheDocument(),(0,external_vitest_namespaceObject.expect)(e("render-ssr-content")).toBeInTheDocument()}),(0,external_vitest_namespaceObject.it)("should not block SSR provider content when SSR provider wraps ConsentManager",async()=>{let{getByTestId:e}=(0,external_vitest_browser_react_namespaceObject.render)((0,jsx_runtime_namespaceObject.jsx)(MockSSRProvider,{children:(0,jsx_runtime_namespaceObject.jsx)(external_consent_manager_provider_cjs_namespaceObject.ConsentManagerProvider,{options:{mode:"offline",consentCategories:["necessary","marketing"]},children:(0,jsx_runtime_namespaceObject.jsx)(RenderTracker,{label:"nested-content"})})}));(0,external_vitest_namespaceObject.expect)(e("ssr-provider")).toBeInTheDocument(),(0,external_vitest_namespaceObject.expect)(e("render-nested-content")).toBeInTheDocument(),(0,external_vitest_namespaceObject.expect)(e("render-nested-content")).toHaveTextContent("nested-content"),await external_vitest_namespaceObject.vi.runAllTimersAsync(),(0,external_vitest_namespaceObject.expect)(e("ssr-provider")).toBeInTheDocument(),(0,external_vitest_namespaceObject.expect)(e("render-nested-content")).toBeInTheDocument()}),(0,external_vitest_namespaceObject.it)("should handle rapid re-renders without blocking children",async()=>{let{rerender:e,getByTestId:t}=(0,external_vitest_browser_react_namespaceObject.render)((0,jsx_runtime_namespaceObject.jsx)(external_consent_manager_provider_cjs_namespaceObject.ConsentManagerProvider,{options:{mode:"offline",consentCategories:["necessary"]},children:(0,jsx_runtime_namespaceObject.jsx)(RenderTracker,{label:"rapid-render"})}));(0,external_vitest_namespaceObject.expect)(t("render-rapid-render")).toBeInTheDocument();for(let n=0;n<3;n++)e((0,jsx_runtime_namespaceObject.jsx)(external_consent_manager_provider_cjs_namespaceObject.ConsentManagerProvider,{options:{mode:"offline",consentCategories:["necessary","marketing"]},children:(0,jsx_runtime_namespaceObject.jsx)(RenderTracker,{label:"rapid-render"})})),(0,external_vitest_namespaceObject.expect)(t("render-rapid-render")).toBeInTheDocument(),await external_vitest_namespaceObject.vi.runAllTimersAsync()}),(0,external_vitest_namespaceObject.it)("should use startTransition for non-blocking state updates during hydration",async()=>{let e=!1,{getByTestId:t}=(0,external_vitest_browser_react_namespaceObject.render)((0,jsx_runtime_namespaceObject.jsx)(external_consent_manager_provider_cjs_namespaceObject.ConsentManagerProvider,{options:{mode:"offline",consentCategories:["necessary"]},children:(0,jsx_runtime_namespaceObject.jsx)(()=>(e=!0,(0,jsx_runtime_namespaceObject.jsx)("div",{"data-testid":"hydration-test",children:"Content"})),{})}));(0,external_vitest_namespaceObject.expect)(e).toBe(!0),(0,external_vitest_namespaceObject.expect)(t("hydration-test")).toBeInTheDocument(),await external_vitest_namespaceObject.vi.runAllTimersAsync(),(0,external_vitest_namespaceObject.expect)(t("hydration-test")).toBeInTheDocument()})}),__webpack_exports__)exports[__webpack_i__]=__webpack_exports__[__webpack_i__];Object.defineProperty(exports,"__esModule",{value:!0});