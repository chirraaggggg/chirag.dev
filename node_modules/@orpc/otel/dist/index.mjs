import { propagation, context, trace } from '@opentelemetry/api';
import { InstrumentationBase } from '@opentelemetry/instrumentation';
import { setGlobalOtelConfig } from '@orpc/shared';

const ORPC_OTEL_PACKAGE_NAME = "@orpc/otel";
const ORPC_OTEL_PACKAGE_VERSION = "1.13.0";

class ORPCInstrumentation extends InstrumentationBase {
  constructor(config = {}) {
    super(ORPC_OTEL_PACKAGE_NAME, ORPC_OTEL_PACKAGE_VERSION, config);
  }
  init() {
  }
  enable() {
    setGlobalOtelConfig({
      tracer: trace.getTracer(ORPC_OTEL_PACKAGE_NAME, ORPC_OTEL_PACKAGE_VERSION),
      trace,
      context,
      propagation
    });
  }
  disable() {
    setGlobalOtelConfig(void 0);
  }
}

export { ORPCInstrumentation };
