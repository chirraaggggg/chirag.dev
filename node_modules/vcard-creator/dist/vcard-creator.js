!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.vcardcreator=t():e.vcardcreator=t()}("undefined"!=typeof self?self:this,(()=>{return e={20:(e,t,r)=>{var n=r(595);e.exports=function(e,t,r){return(t=n(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},e.exports.__esModule=!0,e.exports.default=e.exports},110:(e,t,r)=>{var n=r(871).default;e.exports=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports},136:function(e,t,r){var n,i,o;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,i=[t,r(704)],void 0===(o="function"==typeof(n=function(e,t){"use strict";var n=r(957);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,t=n(t),e.default=t.default})?n.apply(t,i):n)||(e.exports=o)},215:function(e,t){var r,n;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,void 0===(n="function"==typeof(r=function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MIME_TYPES=e.Formats=e.DEFAULT_MIME_TYPE=e.DEFAULT_FORMAT=e.DEFAULT_FILENAME=e.DEFAULT_EXTENSION=e.DEFAULT_CONTENT_TYPE=e.DEFAULT_CHARACTER_SET=e.ContentTypes=e.ALLOWED_MULTIPLE_PROPERTIES=void 0;let t=e.ContentTypes=function(e){return e.VCALENDAR="text/x-vcalendar",e.VCARD="text/x-vcard",e}({}),r=e.Formats=function(e){return e.VCALENDAR="vcalendar",e.VCARD="vcard",e}({});e.ALLOWED_MULTIPLE_PROPERTIES=["address","email","phoneNumber","social","url"],e.DEFAULT_CHARACTER_SET="utf-8",e.DEFAULT_CONTENT_TYPE=t.VCARD,e.DEFAULT_EXTENSION="vcf",e.DEFAULT_FILENAME="vcard",e.DEFAULT_FORMAT=r.VCARD,e.DEFAULT_MIME_TYPE="JPEG",e.MIME_TYPES=["aces","avci","avcs","avif","bmp","cgm","dicom-rle","emf","example","fits","g3fax","gif","heic","heic-sequence","heif","heif-sequence","hej2k","hsj2","ief","jls","jp2","jpeg","jph","jphc","jpm","jpx","jxr","jxrA","jxrS","jxs","jxsc","jxsi","jxss","ktx","ktx2","naplps","png","prs.btif","prs.pti","pwg-raster","svg+xml","t38","tiff","tiff-fx","vnd.adobe.photoshop","vnd.airzip.accelerator.azv","vnd.cns.inf2","vnd.dece.graphic","vnd.djvu","vnd.dwg","vnd.dxf","vnd.dvb.subtitle","vnd.fastbidsheet","vnd.fpx","vnd.fst","vnd.fujixerox.edmics-mmr","vnd.fujixerox.edmics-rlc","vnd.globalgraphics.pgb","vnd.microsoft.icon","vnd.mix","vnd.ms-modi","vnd.mozilla.apng","vnd.net-fpx","vnd.pco.b16","vnd.radiance","vnd.sealed.png","vnd.sealedmedia.softseal.gif","vnd.sealedmedia.softseal.jpg","vnd.svf","vnd.tencent.tap","vnd.valve.source.texture","vnd.wap.wbmp","vnd.xiff","vnd.zbrush.pcx","wmf","x-emf","x-wmf"]})?r.apply(t,[t]):r)||(e.exports=n)},443:function(e,t){var r,n;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,void 0===(n="function"==typeof(r=function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;class t extends Error{constructor(e){super(e),Error.captureStackTrace&&Error.captureStackTrace(this,t),this.name="VCardException"}}e.default=t})?r.apply(t,[t]):r)||(e.exports=n)},595:(e,t,r)=>{var n=r(871).default,i=r(110);e.exports=function(e){var t=i(e,"string");return"symbol"==n(t)?t:t+""},e.exports.__esModule=!0,e.exports.default=e.exports},704:function(e,t,r){var n,i,o;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,i=[t,r(20),r(443),r(979),r(215)],n=function(e,t,n,i,o){"use strict";var s=r(957);function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(a=function(e){return e?r:t})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,t=s(t),n=s(n),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=a(t);if(r&&r.has(e))return r.get(e);var n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}return n.default=e,r&&r.set(e,n),n}(o);e.default=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.DEFAULT_FORMAT;(0,t.default)(this,"charset",o.DEFAULT_CHARACTER_SET),(0,t.default)(this,"contentType",o.DEFAULT_CONTENT_TYPE),(0,t.default)(this,"filename",o.DEFAULT_FILENAME),(0,t.default)(this,"fileExtension",o.DEFAULT_EXTENSION),(0,t.default)(this,"properties",[]),(0,t.default)(this,"definedElements",{}),(0,t.default)(this,"multiplePropertiesForElementAllowed",o.ALLOWED_MULTIPLE_PROPERTIES),(0,t.default)(this,"useVCalendar",!1),e===o.Formats.VCALENDAR&&this.setFormat(e)}setFormat(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.DEFAULT_FORMAT;e===o.Formats.VCALENDAR?(console.warn("The format 'vcalendar' is deprecated and will be removed in the next major or minor release. Use 'vcard' instead."),this.contentType=o.ContentTypes.VCALENDAR,this.useVCalendar=!0):e===o.Formats.VCARD&&(this.contentType=o.ContentTypes.VCARD,this.useVCalendar=!1)}addAddress(){let e=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"WORK;POSTAL";const t=`${arguments.length>0&&void 0!==arguments[0]?arguments[0]:""};${arguments.length>1&&void 0!==arguments[1]?arguments[1]:""};${arguments.length>2&&void 0!==arguments[2]?arguments[2]:""};${arguments.length>3&&void 0!==arguments[3]?arguments[3]:""};${arguments.length>4&&void 0!==arguments[4]?arguments[4]:""};${arguments.length>5&&void 0!==arguments[5]?arguments[5]:""};${arguments.length>6&&void 0!==arguments[6]?arguments[6]:""}`;return this.setProperty("address",`ADR${""!==e?`;${e}`:""}${this.getCharsetString()}`,t),this}addBirthday(e){return this.setProperty("birthday","BDAY",e),this}addCompany(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.setProperty("company",`ORG${this.getCharsetString()}`,e+(""!==t?`;${t}`:"")),this}addEmail(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.setProperty("email","EMAIL;INTERNET"+(""!==t?`;${t}`:""),e),this}addJobtitle(e){return this.setProperty("jobtitle",`TITLE${this.getCharsetString()}`,e),this}addRole(e){return this.setProperty("role",`ROLE${this.getCharsetString()}`,e),this}addMediaURL(e,t,r){return this.setProperty(r,`${e};VALUE=uri`,t),this}addMediaContent(e,t,r,o){if(!(0,i.isValidMimeType)(r))throw new n.default(`The MIME Media Type is invalid (${r})`);return this.setProperty(o,`${e};ENCODING=b;TYPE=${r.toUpperCase()}`,t),this}addName(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";const o=[n,t,r,e,i].filter((e=>!!e)),s=`${e};${t};${r};${n};${i}`;return this.setProperty("name",`N${this.getCharsetString()}`,s),this.hasProperty("FN")||this.setProperty("fullname",`FN${this.getCharsetString()}`,o.join(" ").trim()),this}addNickname(e){return this.setProperty("nickname","NICKNAME",Array.isArray(e)?e.join(",").trim():e),this}addNote(e){return this.setProperty("note",`NOTE${this.getCharsetString()}`,e),this}addCategories(e){return this.setProperty("categories",`CATEGORIES${this.getCharsetString()}`,e.join(",").trim()),this}addPhoneNumber(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.setProperty("phoneNumber","TEL"+(""!==t?`;${t}`:""),`${e}`),this}addLogoURL(e){return this.addMediaURL("LOGO",e,"logo"),this}addLogo(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.DEFAULT_MIME_TYPE;return this.addMediaContent("LOGO",e,t,"logo"),this}addPhotoURL(e){return this.addMediaURL("PHOTO",e,"photo"),this}addPhoto(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.DEFAULT_MIME_TYPE;return this.addMediaContent("PHOTO",e,t,"photo"),this}addURL(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.setProperty("url","URL"+(""!==t?`;${t}`:""),e),this}addSocial(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";const n=""!==r?`;x-user=${r}`:"",i=""!==t?`;type=${t}`:"";return this.setProperty("social",`X-SOCIALPROFILE${i}${n}`,e),this}addUID(e){return this.setProperty("uid","UID",e),this}buildVCard(){const e=new Date;let t="";return t+="BEGIN:VCARD\r\n",t+="VERSION:3.0\r\n",t+=`REV:${e.toISOString()}\r\n`,this.getProperties().forEach((e=>{t+=(0,i.fold)(`${e.key}:${(0,i.escape)(e.value)}\r\n`)})),t+="END:VCARD\r\n",t}buildVCalendar(){console.warn("The method 'buildVCalendar' is deprecated and will be removed in the next major or minor release. Use 'buildVCard' instead.");const e=(new Date).toISOString().replace(/-/g,"").replace(/:/g,"").substring(0,13),t=`${e}00`,r=`${e}01`,n=(0,i.b64encode)(this.buildVCard()),o=(0,i.chunkSplit)(n,74,"\n").replace(/(.+)/g," $1");return`BEGIN:VCALENDAR\nVERSION:2.0\nBEGIN:VEVENT\nDTSTART;TZID=Europe/London:${t}\nDTEND;TZID=Europe/London:${r}\nSUMMARY:Click the attachment to save to your contacts\nDTSTAMP:${t}Z\nATTACH;VALUE=BINARY;ENCODING=BASE64;FMTTYPE=text/directory;\n X-APPLE-FILENAME=${this.getFilename()}.${this.getFileExtension()}:\n${o}END:VEVENT\nEND:VCALENDAR\n`}toString(){return this.getOutput()}getCharset(){return this.charset}getCharsetString(){let e="";return this.charset===o.DEFAULT_CHARACTER_SET&&(e=`;CHARSET=${this.charset}`),e}getContentType(){return this.contentType}getFilename(){return this.filename}getFileExtension(){return this.fileExtension}getOutput(){return this.useVCalendar?this.buildVCalendar():this.buildVCard()}getProperties(){return this.properties}hasProperty(e){return this.getProperties().some((t=>t.key===e&&""!==t.value))}setCharset(e){this.charset=e}setFilename(e){e&&(this.filename=e)}setProperty(e,t,r){if(!this.multiplePropertiesForElementAllowed.includes(e)&&this.definedElements[e])throw new n.default(`This element already exists (${e})`);this.definedElements[e]=!0,this.properties.push({key:t,value:r})}}},void 0===(o=n.apply(t,i))||(e.exports=o)},871:e=>{function t(r){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},957:e=>{e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports.default=e.exports},979:function(e,t,r){var n,i,o;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,i=[t,r(215)],n=function(e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.b64encode=function(e){try{return btoa(e)}catch{return Buffer.from(e).toString("base64")}},e.chunkSplit=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:76;const r=t||76,n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"\r\n")||"\r\n";if(t<1)return"";const i=e.match(new RegExp(`.{0,${r}}`,"g"));return i?i.join(n):""},e.escape=function(e){let t=`${e}`.replace(/\r\n/g,"\\n");return t=t.replace(/\n/g,"\\n"),t},e.fold=function(e){return e.length<=75?e:`${(e.match(/.{1,73}/g)||[]).join("\r\n ").trim()}\r\n`},e.isValidMimeType=function(e){return!(!e||!t.MIME_TYPES.includes(e.toLowerCase()))}},void 0===(o=n.apply(t,i))||(e.exports=o)}},t={},function r(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={exports:{}};return e[n].call(o.exports,o,o.exports,r),o.exports}(136);var e,t}));